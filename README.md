# Проектная работа 7 спринта Интеграция Auth Service с Admin_panel и Movie_API
Ссылка на приватный репозиторий с командной работой: https://github.com/fersus85/Auth_sprint_2.git

## Содержание
- [Описание сервиса](#описание-сервиса)
- [Системные требования](#системные-требования)
- [Настройки](#настройки)
- Запуск
  - [Makefile](#запуск-makefile)
  - [Docker](#запуск-docker)
- [Использование](#использование)
- [Контакты и поддержка](#контакты-и-поддержка)
- [Changelog](#changelog)

## Описание сервиса
Онлайн-кинотеатр, состоит из 3 сервисов, которые взаимодействуют друг с другом посредством API:
- **Сервис Аутентификации**: Обеспечивает регистрацию и аутентификацию пользователей, управление учетными записями и безопасность данных. [документация](https://github.com/fersus85/Auth_sprint_1/blob/main/README.md)
- **Сервис Выдачи контента**: Отвечает за предоставление и управление контентом, включая фильмы и сериалы, а также их метаданные. [документация](https://github.com/fersus85/Async_API_sprint_2/blob/main/README.md)
- **Сервис Админ панели**: Предоставляет интерфейс для администраторов, позволяя управлять контентом. [документация](https://github.com/fersus85/Admin_panel/blob/main/README.md)

## Системные требования
- Python 3.10
- Docker
- Docker Compose
- утилита make (опционально)

## Настройки
1. Клонируйте репозиторий:
```bash
  git clone --recurse-submodules https://github.com/fersus85/Auth_sprint_2.git
```
2. Перейдите в директорию проекта:
```bash
  cd Auth_sprint_2
```
3. Инициалируйте и обновите подмодули
```bash
git submodule init
git submodule update
```
4. Создайте сеть в докере:
```bash
docker network create auth_network
```
5. Настройте .env файлы во всех сервисах (см. документацию к ним)

## Запуск Makefile
### Auth
1. Запустите сервис Аутентификации:
```bash
make up-auth
```
2. Выполните миграции сервис Аутентификации:
```bash
make db/migrate-auth
```
3. Подключитесь к контейнеру для создания superuser Аутентификации:
```bash
make su-create
```
4. Создайте superuser Аутентификации:
```bash
python3 cli/superuser.py
```
### Admin
2. Запустите сервис Админ панели:
```bash
make up-admin
```
### Movies_API
TODO

## Запуск Docker
### Auth
1. Запустите сервис Аутентификации:
```bash
docker compose up -d --build
```
2. Выполните миграции сервис Аутентификации:
```bash
docker compose exec fastapi-auth alembic upgrade head
```
3. Подключитесь к контейнеру для создания superuser Аутентификации:
```bash
docker exec -it auth-service-fastapi-auth-1 bash
```
4. Создайте superuser Аутентификации:
```bash
python3 cli/superuser.py
```
### Admin
2. Запустите сервис Админ панели:
```bash
docker compose -f <корень проекта>/Admin_panel/docker-compose.yml up -d --build
```
### Movies_API
TODO

## Makefile
все команды makefile можно увидеть, вызвав
```bash
  make help
```

## Использование
После запуска всех сервисов:
- сервис Аутентификации работает на http://127.0.0.1:80
- сервис Админ панели работает на http://127.0.0.1:90
- сервис Выдачи контента работает на TODO
- Для работы в админ панели пройдите по указанному адресу и введите логин и пароль сsuperuser.

## Контакты и поддержка
Для получения поддержки или вопросов обращайтесь по электронной почте:
- **Тимлид**: deriabin_85@mail.ru
- **Разработчик**: dmitcvetcov@yandex.ru
- **Разработчик**: maximsonis@gmail.com

# Changelog

## [Версия 1.0.0] - 2024-12-18
### Добавлено
- Инициализирована структура папок
- Настроены конфигурации Docker, Nginx
- Партицирована таблица с историей входов

## [Версия 1.0.2] - 2024-1221
### Добавлено
- Добавлен механизм ограничения количества запросов к серверу
- Создана интеграцию Auth-сервиса с административной панелью
- Обновлён makefile
